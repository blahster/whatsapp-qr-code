<!-- filename: index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>WhatsApp QR (India)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      /* Palette: deep navy background, softer teal accent, gentle neutrals */
      :root {
        --bg: #0b1220; /* slightly deeper than before */
        --surface: #0f172a; /* card background */
        --surface-2: #111827; /* darker inner surface */
        --text: #e6edf5; /* soft off-white */
        --muted: #9aa3b2; /* cooler gray for hints */
        --border: #1f2a37; /* card borders */
        --accent: #2dd4bf; /* softer teal (was harsh green) */
        --accent-dark: #14b8a6; /* deeper teal for gradient */
        --accent-contrast: #073c37; /* text color over accent */
        --input-bg: #0b1324; /* input surface */
        --focus-ring: rgba(45, 212, 191, 0.18); /* accent glow */
        --qr-bg: #ffffff; /* QR white background */
        --qr-ink: #121212; /* dark ink for QR */
        --shadow: rgba(0, 0, 0, 0.35);
      }

      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: linear-gradient(180deg, var(--bg), #0c1425 60%, #0a1020);
        color: var(--text);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Helvetica, Arial;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
      }

      .card {
        width: 100%;
        max-width: 860px;
        border: 1px solid var(--border);
        border-radius: 18px;
        overflow: hidden;
        background: var(--surface-2);
        box-shadow: 0 22px 44px var(--shadow);
      }

      .header {
        padding: 16px 20px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, var(--surface), var(--surface-2));
      }

      .title {
        font-size: 20px;
        font-weight: 700;
        letter-spacing: 0.2px;
      }

      .content {
        display: grid;
        grid-template-columns: 1.1fr 1fr;
        gap: 24px;
        padding: 16px;
      }
      @media (max-width: 900px) {
        .content {
          grid-template-columns: 1fr;
          gap: 16px;
          padding: 12px;
        }
      }

      .label {
        font-size: 15px;
        color: var(--muted);
        margin-bottom: 6px;
        font-weight: 600;
      }

      .hint {
        font-size: 15px;
        color: var(--muted);
        text-align: left;
        margin-top: 10px;
        opacity: 0;
        transform: translateY(-4px);
        transition: opacity 0.4s ease, transform 0.4s ease;
      }
      .hint.center {
        text-align: center;
      }
      .hint.visible {
        opacity: 1;
        transform: translateY(0);
      }

      .row {
        display: flex;
        gap: 10px;
        align-items: stretch;
      }
      @media (max-width: 520px) {
        .row {
          flex-direction: column;
          gap: 8px;
        }
      }

      input[type="text"] {
        flex: 1;
        font-size: 16px;
        padding: 12px 14px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: var(--input-bg);
        color: var(--text);
        outline: none;
        min-width: 0;
        transition: border-color 0.2s ease, box-shadow 0.2s ease,
          background 0.2s ease;
      }
      input[type="text"]::placeholder {
        color: #7c8798;
      }
      input[type="text"]:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px var(--focus-ring);
        background: #0c1628;
      }

      button {
        font-size: 15px;
        padding: 12px 14px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: linear-gradient(180deg, var(--accent), var(--accent-dark));
        color: var(--accent-contrast);
        font-weight: 700;
        cursor: pointer;
        white-space: nowrap;
        transition: transform 0.06s ease-in-out, filter 0.15s ease,
          box-shadow 0.15s ease;
        box-shadow: 0 6px 14px rgba(20, 184, 166, 0.25);
      }
      button:hover {
        filter: brightness(1.03);
      }
      button:active {
        transform: translateY(1px);
        box-shadow: 0 4px 10px rgba(20, 184, 166, 0.22);
      }
      @media (max-width: 520px) {
        button {
          width: 100%;
        }
      }
      button:disabled {
        opacity: 0.65;
        cursor: not-allowed;
        filter: saturate(0.85);
        box-shadow: none;
      }

      .error {
        font-size: 12px;
        color: #f8b4b4; /* gentler than #fca5a5 */
        min-height: 16px;
        margin-top: 6px;
      }

      .url {
        font-size: 14px;
        color: var(--muted);
        word-break: break-all;
        padding: 8px 12px;
        background: var(--input-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        margin-top: 8px;
      }
      .url a {
        color: var(--accent);
        text-decoration: none;
        font-weight: 600;
      }
      .url a:hover {
        text-decoration: underline;
      }

      .actions {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        flex-wrap: wrap;
      }
      @media (max-width: 520px) {
        .actions {
          flex-direction: column;
        }
        .actions button {
          width: 100%;
        }
      }

      .qr-card {
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--qr-bg);
        border-radius: 16px;
        border: 1px solid #e5e7eb;
        padding: 16px;
        width: 100%;
        max-width: 100%;
        overflow: hidden;
      }

      canvas {
        display: block;
        width: 100%;
        height: auto;
        max-width: 480px;
        image-rendering: pixelated;
        background: var(--qr-bg);
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div class="header">
        <div class="title">WhatsApp QR Generator — India</div>
      </div>
      <div class="content">
        <div>
          <div class="label">10-digit Indian mobile number</div>
          <div class="row">
            <input
              id="phone"
              type="text"
              inputmode="numeric"
              pattern="[0-9]*"
              placeholder="e.g., 9876543210"
              autofocus
            />
            <button id="generate" type="button">Generate</button>
          </div>
          <div id="error" class="error"></div>
          <div id="urlHint" class="hint" style="display: none">
            Click the link to open in WhatsApp
          </div>
          <div id="url" class="url"></div>
          <div class="actions">
            <button id="copyUrl" disabled>Copy URL</button>
            <button id="download" disabled>Download PNG</button>
          </div>
        </div>

        <div>
          <div
            id="qrHint"
            class="hint"
            style="display: none; margin-bottom: 12px"
          >
            Point your phone camera at the QR and click the link to open in
            WhatsApp
          </div>
          <div class="qr-card">
            <canvas
              id="qrCanvas"
              width="480"
              height="480"
              aria-label="QR code"
            ></canvas>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

    <script>
      const phoneInput = document.getElementById("phone");
      const generateBtn = document.getElementById("generate");
      const errorEl = document.getElementById("error");
      const urlEl = document.getElementById("url");
      const urlHintEl = document.getElementById("urlHint");
      const qrHintEl = document.getElementById("qrHint");
      const canvas = document.getElementById("qrCanvas");
      const copyUrlBtn = document.getElementById("copyUrl");
      const downloadBtn = document.getElementById("download");

      let lastUrl = "";

      const validatePhone = (n) => /^\d{10}$/.test(n);
      const buildUrl = (n) => `https://wa.me/91${n}`;

      function drawToCanvasFromQRCode(qr, canvas, size) {
        canvas.width = size;
        canvas.height = size;

        const ctx = canvas.getContext("2d", { alpha: false });
        ctx.imageSmoothingEnabled = false;

        const count = qr._oQRCode
          ? qr._oQRCode.getModuleCount()
          : qr.getModuleCount();
        const cell = Math.floor(size / count);
        const margin = Math.floor((size - cell * count) / 2);

        ctx.fillStyle =
          getComputedStyle(document.documentElement)
            .getPropertyValue("--qr-bg")
            .trim() || "#ffffff";
        ctx.fillRect(0, 0, size, size);

        ctx.fillStyle =
          getComputedStyle(document.documentElement)
            .getPropertyValue("--qr-ink")
            .trim() || "#000000";
        for (let r = 0; r < count; r++) {
          for (let c = 0; c < count; c++) {
            const dark = qr._oQRCode
              ? qr._oQRCode.isDark(r, c)
              : qr.isDark(r, c);
            if (dark) {
              ctx.fillRect(margin + c * cell, margin + r * cell, cell, cell);
            }
          }
        }
      }

      function generate() {
        const raw = phoneInput.value.trim();
        errorEl.textContent = "";
        urlEl.innerHTML = "";
        urlHintEl.classList.remove("visible");
        qrHintEl.classList.remove("visible");
        urlHintEl.style.display = "none";
        qrHintEl.style.display = "none";

        if (!validatePhone(raw)) {
          errorEl.textContent = "Please enter exactly 10 digits (0–9).";
          return;
        }

        const url = buildUrl(raw);
        lastUrl = url;

        urlEl.innerHTML = `<a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a>`;

        urlHintEl.classList.add("visible");
        qrHintEl.classList.add("visible");
        urlHintEl.style.display = "block";
        qrHintEl.style.display = "block";

        const tempDiv = document.createElement("div");
        const qr = new QRCode(tempDiv, {
          text: url,
          width: 480,
          height: 480,
          colorDark: "#000000",
          colorLight: "#ffffff",
          correctLevel: QRCode.CorrectLevel.Q,
        });

        drawToCanvasFromQRCode(qr, canvas, 480);
        copyUrlBtn.disabled = false;
        downloadBtn.disabled = false;
      }

      function copyUrl() {
        if (!lastUrl) return;
        navigator.clipboard
          .writeText(lastUrl)
          .then(() => {
            copyUrlBtn.textContent = "Copied!";
            setTimeout(() => {
              copyUrlBtn.textContent = "Copy URL";
            }, 1200);
          })
          .catch(() => alert("Could not copy URL"));
      }

      function downloadPNG() {
        if (!lastUrl) return;
        const a = document.createElement("a");
        a.href = canvas.toDataURL("image/png");
        a.download = "whatsapp_qr.png";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }

      // Digits-only and Enter key
      phoneInput.addEventListener("input", (e) => {
        e.target.value = e.target.value.replace(/\D/g, "").slice(0, 10);
        if (e.target.value.length === 10) errorEl.textContent = "";
      });
      phoneInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          generate();
        }
      });

      generateBtn.addEventListener("click", generate);
      copyUrlBtn.addEventListener("click", copyUrl);
      downloadBtn.addEventListener("click", downloadPNG);
    </script>
  </body>
</html>
